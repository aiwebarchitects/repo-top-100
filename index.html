<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Repo Top 100: Best GitHub Repos (2024)</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

    :root {
        --primary-color: #6e48aa;
        --secondary-color: #9d50bb;
        --text-color: #333;
        --bg-color: #f0f0f0;
        --card-bg: #ffffff;
        --hover-color: #8a2be2;
    }

    body {
        font-family: 'Poppins', sans-serif;
        line-height: 1.6;
        color: var(--text-color);
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: linear-gradient(135deg, var(--bg-color), #e0e0e0);
        min-height: 100vh;
        transition: background-color 0.3s ease;
    }

    body.dark-mode {
        --primary-color: #9d50bb;
        --secondary-color: #6e48aa;
        --text-color: #f0f0f0;
        --bg-color: #1a1a1a;
        --card-bg: #2a2a2a;
        --hover-color: #b366cc;
        background: linear-gradient(135deg, var(--bg-color), #2a2a2a);
    }

    h1 {
        text-align: center;
        color: var(--primary-color);
        font-size: 2.5em;
        margin-bottom: 30px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }

    #search-container {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    #search-input {
        flex-grow: 1;
        padding: 12px 20px;
        font-size: 16px;
        border: none;
        border-radius: 25px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }

    #search-input:focus {
        outline: none;
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    #filter-container {
        display: flex;
        gap: 15px;
        margin-bottom: 30px;
        justify-content: center;
    }

    select {
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 20px;
        background-color: var(--card-bg);
        color: var(--text-color);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        cursor: pointer;
    }

    select:hover, select:focus {
        outline: none;
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    #repo-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 30px;
    }

    .repo-card {
        background-color: var(--card-bg);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        position: relative;
    }

    .repo-card:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
    }

    .repo-name {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 15px;
        color: var(--primary-color);
    }

    .repo-description {
        font-size: 14px;
        color: #666;
        margin-bottom: 20px;
        flex-grow: 1;
    }

    .repo-stats {
        display: flex;
        justify-content: space-between;
        font-size: 14px;
        color: #888;
        margin-top: 15px;
    }

    .repo-link {
        display: inline-block;
        margin-top: 15px;
        padding: 8px 15px;
        background-color: var(--primary-color);
        color: white;
        text-decoration: none;
        border-radius: 20px;
        transition: all 0.3s ease;
        text-align: center;
    }

    .repo-link:hover {
        background-color: var(--hover-color);
        transform: translateY(-2px);
    }

    #loading {
        text-align: center;
        font-size: 18px;
        margin-top: 50px;
        color: var(--primary-color);
    }

    #load-more {
        display: block;
        margin: 30px auto;
        padding: 12px 25px;
        font-size: 16px;
        background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
        color: white;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    #load-more:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    .stat-icon {
        margin-right: 5px;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }

    .repo-card:hover .repo-name {
        animation: pulse 1s infinite;
    }

    .toggle-container {
        display: flex;
        justify-content: flex-end;
        margin-bottom: 20px;
    }

    .toggle-dark-mode {
        background-color: var(--primary-color);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 20px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .toggle-dark-mode:hover {
        background-color: var(--hover-color);
    }

    .favorite-btn {
        background-color: transparent;
        border: none;
        cursor: pointer;
        font-size: 20px;
        position: absolute;
        top: 10px;
        right: 10px;
    }

    #random-repo {
        display: block;
        margin: 30px auto;
        padding: 12px 25px;
        font-size: 16px;
        background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
        color: white;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    #random-repo:hover {
        transform: translateY(-3px) rotate(5deg);
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }
</style>
</head>
<body>
    <div class="toggle-container">
        <button class="toggle-dark-mode">Toggle Dark Mode</button>
    </div>
    <h1>Repo Top 100: Best GitHub Repos (2024)</h1>
    <div id="search-container">
        <input type="text" id="search-input" placeholder="Search repositories...">
    </div>
    <div id="filter-container">
        <select id="language-filter">
            <option value="">All Languages</option>
        </select>
        <select id="sort-filter">
            <option value="stars">Stars</option>
            <option value="forks">Forks</option>
            <option value="updated">Last Updated</option>
        </select>
    </div>
    <button id="random-repo">Surprise Me with a Random Repo!</button>
    <div id="repo-list"></div>
    <div id="loading">Loading amazing repos...</div>
    <button id="load-more" style="display: none;">Discover More Gems</button>

<script>
const repoList = document.getElementById('repo-list');
const searchInput = document.getElementById('search-input');
const languageFilter = document.getElementById('language-filter');
const sortFilter = document.getElementById('sort-filter');
const loading = document.getElementById('loading');
const loadMoreButton = document.getElementById('load-more');
const darkModeToggle = document.querySelector('.toggle-dark-mode');
const randomRepoButton = document.getElementById('random-repo');

let allRepos = [];
let languages = new Set();
let currentPage = 1;
const perPage = 30;
let favorites = JSON.parse(localStorage.getItem('favorites')) || [];

darkModeToggle.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
    localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
});

// Check for saved dark mode preference
if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark-mode');
}

async function fetchRepos(page = 1) {
    loading.style.display = 'block';
    try {
        const response = await fetch(`https://api.github.com/search/repositories?q=stars:>1&sort=stars&order=desc&per_page=${perPage}&page=${page}`);
        if (!response.ok) {
            throw new Error('GitHub API request failed');
        }
        const data = await response.json();
        return data.items;
    } catch (error) {
        console.error('Error fetching repositories:', error);
        loading.textContent = 'Error loading repositories. Please try again later.';
        return [];
    } finally {
        loading.style.display = 'none';
    }
}

async function loadMoreRepos() {
    currentPage++;
    const newRepos = await fetchRepos(currentPage);
    allRepos = [...allRepos, ...newRepos];
    updateLanguages(newRepos);
    displayRepos(allRepos);
    if (newRepos.length < perPage) {
        loadMoreButton.style.display = 'none';
    }
}

function updateLanguages(repos) {
    repos.forEach(repo => {
        if (repo.language) {
            languages.add(repo.language);
        }
    });
    updateLanguageFilter();
}

function updateLanguageFilter() {
    languageFilter.innerHTML = '<option value="">All Languages</option>';
    Array.from(languages).sort().forEach(lang => {
        const option = document.createElement('option');
        option.value = lang;
        option.textContent = lang;
        languageFilter.appendChild(option);
    });
}

function displayRepos(repos) {
    repoList.innerHTML = '';
    repos.forEach(repo => {
        const card = document.createElement('div');
        card.className = 'repo-card';
        const isFavorite = favorites.includes(repo.id);
        card.innerHTML = `
            <div class="repo-name">${repo.name}</div>
            <div class="repo-description">${repo.description || 'No description available'}</div>
            <div class="repo-stats">
                <span><span class="stat-icon">‚≠ê</span>${repo.stargazers_count.toLocaleString()}</span>
                <span><span class="stat-icon">üç¥</span>${repo.forks_count.toLocaleString()}</span>
                <span><span class="stat-icon">üî§</span>${repo.language || 'Unknown'}</span>
            </div>
            <a href="${repo.html_url}" target="_blank" rel="noopener noreferrer" class="repo-link">View on GitHub</a>
            <button class="favorite-btn" data-id="${repo.id}">${isFavorite ? '‚ù§Ô∏è' : 'ü§ç'}</button>
        `;
        repoList.appendChild(card);
    });

    // Add event listeners for favorite buttons
    document.querySelectorAll('.favorite-btn').forEach(btn => {
        btn.addEventListener('click', toggleFavorite);
    });
}

function toggleFavorite(event) {
    const repoId = parseInt(event.target.dataset.id);
    const index = favorites.indexOf(repoId);
    if (index > -1) {
        favorites.splice(index, 1);
        event.target.textContent = 'ü§ç';
    } else {
        favorites.push(repoId);
        event.target.textContent = '‚ù§Ô∏è';
    }
    localStorage.setItem('favorites', JSON.stringify(favorites));
}

function filterAndSortRepos() {
    const searchTerm = searchInput.value.toLowerCase();
    const selectedLanguage = languageFilter.value;
    const sortBy = sortFilter.value;

    let filteredRepos = allRepos.filter(repo => 
        repo.name.toLowerCase().includes(searchTerm) &&
        (!selectedLanguage || repo.language === selectedLanguage)
    );

    filteredRepos.sort((a, b) => {
        if (sortBy === 'stars') return b.stargazers_count - a.stargazers_count;
        if (sortBy === 'forks') return b.forks_count - a.forks_count;
        if (sortBy === 'updated') return new Date(b.updated_at) - new Date(a.updated_at);
    });

    displayRepos(filteredRepos);
}

async function initializeApp() {
    const initialRepos = await fetchRepos();
    allRepos = initialRepos;
    updateLanguages(initialRepos);
    displayRepos(initialRepos);
    loadMoreButton.style.display = 'block';
}

function showRandomRepo() {
    if (allRepos.length > 0) {
        const randomIndex = Math.floor(Math.random() * allRepos.length);
        const randomRepo = allRepos[randomIndex];
        displayRepos([randomRepo]);
    }
}

searchInput.addEventListener('input', filterAndSortRepos);
languageFilter.addEventListener('change', filterAndSortRepos);
sortFilter.addEventListener('change', filterAndSortRepos);
loadMoreButton.addEventListener('click', loadMoreRepos);
randomRepoButton.addEventListener('click', showRandomRepo);

initializeApp();
</script>
</body>
</html>
